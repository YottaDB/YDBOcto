#################################################################
#								#
# Copyright (c) 2021 YottaDB LLC and/or its subsidiaries.	#
# All rights reserved.						#
#								#
#	This source code contains the intellectual property	#
#	of its copyright holder(s), and is made available	#
#	under a license.  If you do not know the terms of	#
#	the license, please stop and do not read further.	#
#								#
#################################################################

-- TTA002 : OCTO759 : COUNT(DISTINCT TABLENAME.ASTERISK) produces incorrect results in some cases : names database

-- Below are simpler queries (than noted in TTA001.sql) that demonstrate the same YDBOcto#759 issue.
-- Some of them are included more for completeness of testing even though they passed without the YDBOcto#759 fixes.

-- Below is from a query noted at https://gitlab.com/YottaDB/DBMS/YDBOcto/-/issues/759#note_728237002
SELECT COUNT(DISTINCT n1.*) FROM (SELECT 'Joey' UNION SELECT NULL) n1;

-- Below are queries noted at https://gitlab.com/YottaDB/DBMS/YDBOcto/-/issues/759#note_729525246
SELECT COUNT(DISTINCT n1.*) FROM (VALUES ('Joey'), (NULL)) n1;
SELECT COUNT(DISTINCT n1.*) FROM (VALUES ('Joey', 'dummy'), (NULL, 'dummy')) n1;

-- Below are queries that use the names database and demonstrate similar issues with COUNT(DISTINCT TABLENAME.ASTERISK)
SELECT COUNT(DISTINCT n1.*) FROM (SELECT lastname from names) n1;

-- Below are queries that test the issue with IS NOT NULL or IS NULL and TABLENAME.ASTERISK in HAVING clause
-- Details of issue at https://gitlab.com/YottaDB/DBMS/YDBOcto/-/issues/759#note_737359086
SELECT 1 FROM names n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM names n1 GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING n1.* IS NULL;

-- Below are queries that test the issue with IS NOT NULL or IS NULL and TABLENAME.ASTERISK in WHERE clause
-- Details of issue at https://gitlab.com/YottaDB/DBMS/YDBOcto/-/issues/759#note_740303970
SELECT 1 FROM names n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM names n1 WHERE n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 WHERE n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 WHERE n1.* IS NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 WHERE n1.* IS NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 WHERE n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 WHERE n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 WHERE n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 WHERE n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 WHERE n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 WHERE n1.* IS NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 WHERE n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 WHERE n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NULL;

-- Below 2 sections of queries are similar to above 2 sections except that they have n1.* usages in both WHERE and HAVING clauses
SELECT 1 FROM names n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM names n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NULL;

SELECT 1 FROM names n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM names n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NOT NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE n1.* IS NULL GROUP BY n1.* HAVING n1.* IS NOT NULL;

-- Below are queries similar to the above but using
--	1) NOT n1.* IS NULL instead of n1.* IS NOT NULL AND
--	2) NOT n1.* IS NOT NULL instead of n1.* IS NULL

-- Details of issue at https://gitlab.com/YottaDB/DBMS/YDBOcto/-/issues/759#note_737359086
SELECT 1 FROM names n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM names n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;

-- Below are queries that test the issue with IS NOT NULL or IS NULL and TABLENAME.ASTERISK in WHERE clause
-- Details of issue at https://gitlab.com/YottaDB/DBMS/YDBOcto/-/issues/759#note_740303970
SELECT 1 FROM names n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM names n1 WHERE NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 WHERE NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 WHERE NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 WHERE NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 WHERE NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 WHERE NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 WHERE NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 WHERE NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL;

-- Below 2 sections of queries are similar to above 2 sections except that they have n1.* usages in both WHERE and HAVING clauses
SELECT 1 FROM names n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM names n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT n1.* IS NOT NULL;

SELECT 1 FROM names n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM names n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd')) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh')) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh')) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh')) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh')) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;
SELECT 1 FROM (VALUES (1, 'abcd'), (2, NULL), (NULL, 'efgh'), (NULL, NULL)) n1 WHERE NOT n1.* IS NOT NULL GROUP BY n1.* HAVING NOT NOT n1.* IS NOT NULL;

