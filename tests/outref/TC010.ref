
-- TC010 : OCTO381 : Allow DATE and TIME types to be specified in the Octo DDL but treated as strings internally

-- Test that DATE and TIME types work (TIME specified without any precision)
CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME) READONLY;
SELECT date1 from DATETIME;
SELECT time1 from DATETIME;
SELECT id::DATE from DATETIME;
SELECT id::TIME from DATETIME;
SELECT date1::integer from DATETIME;
SELECT date1::numeric from DATETIME;
SELECT date1::varchar from DATETIME;
SELECT date1::text from DATETIME;
SELECT date1::date from DATETIME;
SELECT date1::time from DATETIME;
DROP TABLE DATETIME;

-- Uncomment the following when precision for time types are implemented
-- Test that TIME(precision) (TIME type specified with precision) also works
--CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME(6)) READONLY;
--SELECT time1 from DATETIME;
--SELECT time1::integer from DATETIME;
--SELECT time1::numeric from DATETIME;
--SELECT time1::varchar from DATETIME;
--SELECT time1::text from DATETIME;
--SELECT time1::date from DATETIME;
--SELECT time1::time from DATETIME;
--DROP TABLE DATETIME;

-- Test that various precision values work with TIME
-- CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME(10)) READONLY;
-- DROP TABLE DATETIME;
-- CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME(4)) READONLY;
-- DROP TABLE DATETIME;
-- CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME(8)) READONLY;
-- DROP TABLE DATETIME;
-- CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME(16)) READONLY;
-- DROP TABLE DATETIME;
-- CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME(32)) READONLY;
-- DROP TABLE DATETIME;
-- CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME(64)) READONLY;
-- DROP TABLE DATETIME;
-- CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME(127)) READONLY;
-- DROP TABLE DATETIME;
-- CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME(0)) READONLY;
-- DROP TABLE DATETIME;
-- CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME(-1)) READONLY;
-- DROP TABLE DATETIME;
-- CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME(-1.5)) READONLY;
-- DROP TABLE DATETIME;
-- CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME(15.8)) READONLY;
-- DROP TABLE DATETIME;
-- CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME('abcd')) READONLY;
-- DROP TABLE DATETIME;
-- CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME(abcd)) READONLY;
-- DROP TABLE DATETIME;

OCTO> CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME) READONLY;
CREATE TABLE
OCTO> SELECT date1 from DATETIME;
date1
2020-01-04
1998-11-13
2005-09-22
1975-05-31
(4 rows)
OCTO> SELECT time1 from DATETIME;
time1
14:01:10
14:12:59
13:23:09
15:15:22
(4 rows)
[ERROR]: ERR_TYPE_CAST: Cannot cast type INTEGER to type DATE
LINE 6:1: SELECT id::DATE from DATETIME;
                 ^^^^^^^^
OCTO> SELECT id::DATE from DATETIME;
[ERROR]: ERR_TYPE_CAST: Cannot cast type INTEGER to type TIME
LINE 7:1: SELECT id::TIME from DATETIME;
                 ^^^^^^^^
OCTO> SELECT id::TIME from DATETIME;
[ERROR]: ERR_TYPE_CAST: Cannot cast type DATE to type INTEGER
LINE 8:1: SELECT date1::integer from DATETIME;
                 ^^^^^^^^^^^^^^
OCTO> SELECT date1::integer from DATETIME;
[ERROR]: ERR_TYPE_CAST: Cannot cast type DATE to type NUMERIC
LINE 9:1: SELECT date1::numeric from DATETIME;
                 ^^^^^^^^^^^^^^
OCTO> SELECT date1::numeric from DATETIME;
OCTO> SELECT date1::varchar from DATETIME;
date1
2020-01-04
1998-11-13
2005-09-22
1975-05-31
(4 rows)
OCTO> SELECT date1::text from DATETIME;
date1
2020-01-04
1998-11-13
2005-09-22
1975-05-31
(4 rows)
OCTO> SELECT date1::date from DATETIME;
date1
2020-01-04
1998-11-13
2005-09-22
1975-05-31
(4 rows)
[ERROR]: ERR_TYPE_CAST: Cannot cast type DATE to type TIME
LINE 13:1: SELECT date1::time from DATETIME;
                  ^^^^^^^^^^^
OCTO> SELECT date1::time from DATETIME;
OCTO> DROP TABLE DATETIME;
DROP TABLE
OCTO> --CREATE TABLE DATETIME (id INTEGER PRIMARY KEY, date1 DATE, time1 TIME(6)) READONLY;
--SELECT time1 from DATETIME;
--SELECT time1::integer from DATETIME;
--SELECT time1::numeric from DATETIME;
--SELECT time1::varchar from DATETIME;
--SELECT time1::text from DATETIME;
--SELECT time1::date from DATETIME;
--SELECT time1::time from DATETIME;
--DROP TABLE DATETIME;


