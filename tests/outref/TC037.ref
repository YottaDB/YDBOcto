# Test DELIM "" without and with PIECE specified

-- TC037 : OCTO589 : DELIM "" at the column level invalidates any PIECE specified and fetches entire node

-- Test DELIM "" without PIECE specified at the column level
CREATE TABLE names1 (
	id INTEGER PRIMARY KEY,
	firstName VARCHAR(30) DELIM "",
	lastName TEXT(30)
) GLOBAL "^names(keys(""id""))";

SELECT * FROM names1;

-- Test DELIM "" with PIECE specified at the column level
CREATE TABLE names2 (
	id INTEGER PRIMARY KEY,
	firstName VARCHAR(30) DELIM "" PIECE 2,
	lastName TEXT(30)
) GLOBAL "^names(keys(""id""))";

SELECT * FROM names2;

ID|FIRSTNAME|LASTNAME
0|Zero|Cool|Zero
1|Acid|Burn|Acid
2|Cereal|Killer|Cereal
3|Lord|Nikon|Lord
4|Joey||Joey
5|Zero|Cool|Zero
(6 rows)
ID|FIRSTNAME|LASTNAME
0|Zero|Cool|Zero
1|Acid|Burn|Acid
2|Cereal|Killer|Cereal
3|Lord|Nikon|Lord
4|Joey||Joey
5|Zero|Cool|Zero
(6 rows)
# Verify generated plans do not have $PIECE for FIRSTNAME column
_ydboctoP*.m:    . . SET %ydboctoexpr=$$colvalue2null^%ydboctoplanhelpers(^names(%ydboctocursor(cursorId,"keys",1,"NAMES2","ID")),0,-1,"VARCHAR")
_ydboctoP*.m:    . . SET %ydboctoexpr=$$colvalue2null^%ydboctoplanhelpers($PIECE($GET(^names(%ydboctocursor(cursorId,"keys",1,"NAMES2","ID"))),"|",1),0,-1,"VARCHAR")
_ydboctoP*.m:    . . SET %ydboctoexpr=$$colvalue2null^%ydboctoplanhelpers(^names(%ydboctocursor(cursorId,"keys",1,"NAMES1","ID")),0,-1,"VARCHAR")
_ydboctoP*.m:    . . SET %ydboctoexpr=$$colvalue2null^%ydboctoplanhelpers($PIECE($GET(^names(%ydboctocursor(cursorId,"keys",1,"NAMES1","ID"))),"|",1),0,-1,"VARCHAR")
# Verify text table definition does not have PIECE specified for FIRSTNAME column
^%ydboctoschema("NAMES1","text",0)="CREATE TABLE `NAMES1` (`ID` INTEGER PRIMARY KEY, `FIRSTNAME` VARCHAR(30) DELIM """", `LASTNAME` VARCHAR(30) PIECE 1) GLOBAL ""^names(keys(""""id""""))"" DELIM ""|"";"
^%ydboctoschema("NAMES2","text",0)="CREATE TABLE `NAMES2` (`ID` INTEGER PRIMARY KEY, `FIRSTNAME` VARCHAR(30) DELIM """", `LASTNAME` VARCHAR(30) PIECE 1) GLOBAL ""^names(keys(""""id""""))"" DELIM ""|"";"
