
-- TC040 : OCTO590 : Confirm enforcement of table name length limits during table creation and cleanup

-- 64-byte table name (exceeds 63-byte limit and so should fail)
CREATE TABLE namesLongStringABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvw (
        id INTEGER PRIMARY KEY,
        firstName VARCHAR(30),
        lastName TEXT(30)
) GLOBAL "^names(keys(""id""))";

SELECT * from namesLongStringABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvw;

-- 63-byte table name (meets 63-byte limit and so should succeed)
CREATE TABLE namesLongStringABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuv (
        id INTEGER PRIMARY KEY,
        firstName VARCHAR(30),
        lastName TEXT(30)
) GLOBAL "^names(keys(""id""))";

SELECT * from namesLongStringABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuv;

-- 64-byte table name using '.' to force 'LITERAL PERIOD LITERAL' parser code path (exceeds 63-byte limit and so should fail)
CREATE TABLE namesLongString.ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvw (
        id INTEGER PRIMARY KEY,
        firstName VARCHAR(30),
        lastName TEXT(30)
) GLOBAL "^names(keys(""id""))";

SELECT * from namesLongString.ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuv;

[ERROR]: ERR_IDENT_LENGTH: Identifier length 64 exceeds max (63)
LINE 3:1: ...namesLongStringABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvw...
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[ERROR]: ERR_IDENT_LENGTH: Identifier length 64 exceeds max (63)
LINE 9:1: ...namesLongStringABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvw...
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
CREATE TABLE
ID|FIRSTNAME|LASTNAME
0|Zero|Cool
1|Acid|Burn
2|Cereal|Killer
3|Lord|Nikon
4|Joey|
5|Zero|Cool
(6 rows)
[ERROR]: ERR_IDENT_LENGTH: Identifier length 65 exceeds max (63)
LINE 19:1: ...namesLongString.ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuv...
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[ERROR]: ERR_IDENT_LENGTH: Identifier length 64 exceeds max (63)
LINE 25:1: ...namesLongString.ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuv...
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
