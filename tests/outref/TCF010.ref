
-- TCF010 : OCTO345 : CREATE FUNCTION with various return types

-- Return type of BOOLEAN
CREATE FUNCTION RETTRUE() RETURNS BOOLEAN AS $$RETTRUE^TCF010;
CREATE FUNCTION RETFALSE() RETURNS BOOLEAN AS $$RETFALSE^TCF010;
SELECT RETTRUE() || id::text FROM names;
SELECT id FROM names WHERE RETTRUE();
SELECT lastname FROM names WHERE RETFALSE();

CREATE FUNCTION RETTRUESTR() RETURNS BOOLEAN AS $$RETTRUESTR^TCF010;
CREATE FUNCTION RETFALSESTR() RETURNS BOOLEAN AS $$RETFALSESTR^TCF010;
SELECT RETTRUESTR() || id::text FROM names;
SELECT id FROM names WHERE RETTRUESTR();
SELECT lastname FROM names WHERE RETFALSESTR();

-- Return type of INTEGER
CREATE FUNCTION RETINT(INTEGER) RETURNS INTEGER AS $$RETINT^TCF010;
SELECT * FROM names WHERE id = RETINT(1) OR id = RETINT(2);
SELECT * FROM names WHERE id = (RETINT(1)+RETINT(2));

-- Return type of NUMERIC
CREATE FUNCTION RETNUM(NUMERIC) RETURNS NUMERIC AS $$RETINT^TCF010;
SELECT RETNUM(3.14) FROM names;
SELECT * FROM names WHERE id = (RETNUM(2.5) + RETNUM(2.5));
SELECT * FROM names WHERE id = RETNUM(3.14)::integer;

-- Return type of VARCHAR
CREATE FUNCTION RETVARCHAR2(NUMERIC, VARCHAR) RETURNS VARCHAR AS $$RETVARCHAR2^TCF010;
SELECT RETVARCHAR2(3.14, '... is pi') FROM names;
CREATE FUNCTION RETVARCHAR(VARCHAR) RETURNS VARCHAR AS $$RETVARCHAR^TCF010;
SELECT * FROM names WHERE firstname = RETVARCHAR(firstname);
SELECT firstname FROM names WHERE firstname = (RETVARCHAR('Ze') || RETVARCHAR('ro')) OR lastname = (RETVARCHAR('B') || RETVARCHAR('u') ||RETVARCHAR('rn'));

CREATE FUNCTION
CREATE FUNCTION
RETTRUE
true0
true1
true2
true3
true4
true5
(6 rows)
ID
0
1
2
3
4
5
(6 rows)
LASTNAME
(0 rows)
CREATE FUNCTION
CREATE FUNCTION
RETTRUESTR
true0
true1
true2
true3
true4
true5
(6 rows)
ID
0
1
2
3
4
5
(6 rows)
LASTNAME
(0 rows)
CREATE FUNCTION
ID|FIRSTNAME|LASTNAME
1|Acid|Burn
2|Cereal|Killer
(2 rows)
ID|FIRSTNAME|LASTNAME
3|Lord|Nikon
(1 row)
CREATE FUNCTION
RETNUM
3.14
3.14
3.14
3.14
3.14
3.14
(6 rows)
ID|FIRSTNAME|LASTNAME
5|Zero|Cool
(1 row)
ID|FIRSTNAME|LASTNAME
3|Lord|Nikon
(1 row)
CREATE FUNCTION
RETVARCHAR2
3.14... is pi
3.14... is pi
3.14... is pi
3.14... is pi
3.14... is pi
3.14... is pi
(6 rows)
CREATE FUNCTION
ID|FIRSTNAME|LASTNAME
0|Zero|Cool
1|Acid|Burn
2|Cereal|Killer
3|Lord|Nikon
4|Joey|
5|Zero|Cool
(6 rows)
FIRSTNAME
Zero
Zero
Acid
(3 rows)
