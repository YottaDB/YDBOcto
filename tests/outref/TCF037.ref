
-- TCF037 : OCTO816 and OCTO1010 : Test NULL/INTEGER literals in functions with large number of parameters

-- Test of https://gitlab.com/YottaDB/DBMS/YDBOcto/-/issues/816#note_1514490913
-- Test that below query does not take forever to run
CREATE FUNCTION MAXARGS(INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER) RETURNS NUMERIC AS $$^MAXARGS;
SELECT MAXARGS(NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, id) FROM names;

-- Test of https://gitlab.com/YottaDB/DBMS/YDBOcto/-/issues/816#note_1515900594
-- Test that below query does not take forever to run
CREATE FUNCTION MAXARGS(NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC) RETURNS NUMERIC AS $$^MAXARGS;
SELECT MAXARGS(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, id) FROM names;

-- Test ERR_UNKNOWN_FUNCTION error in function with lots of parameters for query in https://gitlab.com/YottaDB/DBMS/YDBOcto/-/issues/816#note_1514490913
SELECT MAXARGS(NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, firstname) FROM names;

-- Test ERR_UNKNOWN_FUNCTION error in function with lots of parameters for query in https://gitlab.com/YottaDB/DBMS/YDBOcto/-/issues/816#note_1515900594
SELECT MAXARGS(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, firstname) FROM names;

-- Test ERR_FUNCTION_NOT_UNIQUE error in function with lots of parameters for query in https://gitlab.com/YottaDB/DBMS/YDBOcto/-/issues/816#note_1514490913
CREATE FUNCTION MAXARGS(INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, NUMERIC) RETURNS NUMERIC AS $$NUMERIC^MAXARGS;
SELECT MAXARGS(NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, id) FROM names;

-- Test ERR_FUNCTION_NOT_UNIQUE error in function with lots of parameters for query in https://gitlab.com/YottaDB/DBMS/YDBOcto/-/issues/816#note_1515900594
CREATE FUNCTION MAXARGS(NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, NUMERIC, INTEGER, INTEGER) RETURNS NUMERIC AS $$INTEGER^MAXARGS;
SELECT MAXARGS(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, NULL, id) FROM names;

-- Test https://gitlab.com/YottaDB/DBMS/YDBOcto/-/issues/816#note_887646106
CREATE FUNCTION SAMEVALUE(INTEGER) RETURNS INTEGER AS $$samevalue1^functions;
CREATE FUNCTION SAMEVALUE(NUMERIC) RETURNS NUMERIC AS $$samevalue2^functions;
CREATE FUNCTION SAMEVALUE(VARCHAR) RETURNS VARCHAR AS $$samevalue^functions;
CREATE FUNCTION SAMEVALUE(BOOLEAN) RETURNS BOOLEAN AS $$samevalue^functions;
SELECT SAMEVALUE(NULL);	-- expect SAMEVALUE(VARCHAR) to be chosen with no error
DROP FUNCTION IF EXISTS SAMEVALUE(varchar);
SELECT SAMEVALUE(NULL); -- expect ERR_FUNCTION_NOT_UNIQUE error
DROP FUNCTION IF EXISTS SAMEVALUE(numeric);
SELECT SAMEVALUE(NULL); -- expect ERR_FUNCTION_NOT_UNIQUE error
DROP FUNCTION IF EXISTS SAMEVALUE(integer);
SELECT SAMEVALUE(NULL); -- expect SAMEVALUE(BOOLEAN) to be chosen with no error
DROP FUNCTION IF EXISTS samevalue(boolean);
SELECT samevalue(NULL); -- expect ERR_UNKNOWN_FUNCTION error

CREATE FUNCTION
maxargs






(6 rows)
CREATE FUNCTION
maxargs
31
32
33
34
35
36
(6 rows)
[ERROR]: ERR_UNKNOWN_FUNCTION: No function maxargs defined with given parameter types (NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, VARCHAR)
LINE 9:1: SELECT MAXARGS(NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, ...
                 ^^^^^^^
[ERROR]: ERR_UNKNOWN_FUNCTION: No function maxargs defined with given parameter types (INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, VARCHAR)
LINE 11:1: SELECT MAXARGS(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
                  ^^^^^^^
CREATE FUNCTION
[ERROR]: ERR_FUNCTION_NOT_UNIQUE: Function 'maxargs(NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, INTEGER)' not unique. Parameter(s) may require explicit type cast(s)
LINE 14:1: SELECT MAXARGS(NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, ...
                  ^^^^^^^
CREATE FUNCTION
[ERROR]: ERR_FUNCTION_NOT_UNIQUE: Function 'maxargs(INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, NULL, INTEGER)' not unique. Parameter(s) may require explicit type cast(s)
LINE 17:1: SELECT MAXARGS(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
                  ^^^^^^^
CREATE FUNCTION
CREATE FUNCTION
CREATE FUNCTION
CREATE FUNCTION
samevalue

(1 row)
DROP FUNCTION
[ERROR]: ERR_FUNCTION_NOT_UNIQUE: Function 'samevalue(NULL)' not unique. Parameter(s) may require explicit type cast(s)
LINE 25:1: SELECT SAMEVALUE(NULL); -- expect ERR_FUNCTION_NOT_UNIQUE error
                  ^^^^^^^^^
DROP FUNCTION
[ERROR]: ERR_FUNCTION_NOT_UNIQUE: Function 'samevalue(NULL)' not unique. Parameter(s) may require explicit type cast(s)
LINE 27:1: SELECT SAMEVALUE(NULL); -- expect ERR_FUNCTION_NOT_UNIQUE error
                  ^^^^^^^^^
DROP FUNCTION
samevalue

(1 row)
DROP FUNCTION
[ERROR]: ERR_UNKNOWN_FUNCTION: No function samevalue defined with given parameter types (NULL)
LINE 31:1: SELECT samevalue(NULL); -- expect ERR_UNKNOWN_FUNCTION error
                  ^^^^^^^^^
