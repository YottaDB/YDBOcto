
select date(fileman)'3230101'::DATE;
select date(fileman)'3230101'::TIMESTAMP;
select date(fileman)'3230101'::TIMESTAMP WITH TIME ZONE;
select date(fileman)'3230101'::VARCHAR;

select time(fileman)'010101'::TIME;
select time(fileman)'010101'::TIME WITH TIME ZONE;
select time(fileman)'010101'::VARCHAR;

select timestamp(fileman)'3230101.010101'::DATE;
select timestamp(fileman)'3230101.010101'::TIME;
select timestamp(fileman)'3230101.010101'::TIMESTAMP;
select timestamp(fileman)'3230101.010101'::TIMESTAMP WITH TIME ZONE;
select timestamp(fileman)'3230101.010101'::VARCHAR;

select CAST(date(fileman)'3230101'AS DATE);
select CAST(date(fileman)'3230101'AS TIMESTAMP);
select CAST(date(fileman)'3230101'AS TIMESTAMP WITH TIME ZONE);
select CAST(date(fileman)'3230101'AS VARCHAR);

select CAST(time(fileman)'010101'AS TIME);
select CAST(time(fileman)'010101'AS TIME WITH TIME ZONE);
select CAST(time(fileman)'010101'AS VARCHAR);

select CAST(timestamp(fileman)'3230101.010101'AS DATE);
select CAST(timestamp(fileman)'3230101.010101'AS TIME);
select CAST(timestamp(fileman)'3230101.010101'AS TIMESTAMP);
select CAST(timestamp(fileman)'3230101.010101'AS TIMESTAMP WITH TIME ZONE);
select CAST(timestamp(fileman)'3230101.010101'AS VARCHAR);

-- More detailed tests
select timestamp(fileman)'3230101.010101'::time < time'01:02:01'; -- Should return `true`
select timestamp(fileman)'3230101.010101'::date < date'2023-01-02'; -- Should return `true`
select (timestamp(fileman)'3230101.010101'::date)::varchar ='2023-01-01'; -- Should return `true`
select (timestamp(fileman)'3230101.010101'::date) ='2023-01-01'::date; -- Should return `true`

select date(fileman)'3230101'::VARCHAR(2);
select date(fileman)'3230101'::VARCHAR(3);
select time(fileman)'010101'::VARCHAR(3);
select timestamp(fileman)'3230101.010101'::VARCHAR(3);

OCTO> select date(fileman)'3230101'::DATE;
DATE
2023-01-01
(1 row)
OCTO> select date(fileman)'3230101'::TIMESTAMP;
TIMESTAMP
2023-01-01 00:00:00
(1 row)
OCTO> select date(fileman)'3230101'::TIMESTAMP WITH TIME ZONE;
TIMESTAMPTZ
2023-01-01 00:00:00-05
(1 row)
OCTO> select date(fileman)'3230101'::VARCHAR;
VARCHAR
2023-01-01
(1 row)
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 7:1: select time(fileman)'010101'::TIME;
                 ^^^^^^^^^^^^^
OCTO> select time(fileman)'010101'::TIME;
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 8:1: select time(fileman)'010101'::TIME WITH TIME ZONE;
                 ^^^^^^^^^^^^^
OCTO> select time(fileman)'010101'::TIME WITH TIME ZONE;
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 9:1: select time(fileman)'010101'::VARCHAR;
                 ^^^^^^^^^^^^^
OCTO> select time(fileman)'010101'::VARCHAR;
OCTO> select timestamp(fileman)'3230101.010101'::DATE;
DATE
2023-01-01
(1 row)
OCTO> select timestamp(fileman)'3230101.010101'::TIME;
TIME
01:01:01
(1 row)
OCTO> select timestamp(fileman)'3230101.010101'::TIMESTAMP;
TIMESTAMP
2023-01-01 01:01:01
(1 row)
OCTO> select timestamp(fileman)'3230101.010101'::TIMESTAMP WITH TIME ZONE;
TIMESTAMPTZ
2023-01-01 01:01:01-05
(1 row)
OCTO> select timestamp(fileman)'3230101.010101'::VARCHAR;
VARCHAR
2023-01-01 01:01:01
(1 row)
OCTO> select CAST(date(fileman)'3230101'AS DATE);
DATE
2023-01-01
(1 row)
OCTO> select CAST(date(fileman)'3230101'AS TIMESTAMP);
TIMESTAMP
2023-01-01 00:00:00
(1 row)
OCTO> select CAST(date(fileman)'3230101'AS TIMESTAMP WITH TIME ZONE);
TIMESTAMPTZ
2023-01-01 00:00:00-05
(1 row)
OCTO> select CAST(date(fileman)'3230101'AS VARCHAR);
VARCHAR
2023-01-01
(1 row)
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 22:1: select CAST(time(fileman)'010101'AS TIME);
                       ^^^^^^^^^^^^^
OCTO> select CAST(time(fileman)'010101'AS TIME);
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 23:1: select CAST(time(fileman)'010101'AS TIME WITH TIME ZONE);
                       ^^^^^^^^^^^^^
OCTO> select CAST(time(fileman)'010101'AS TIME WITH TIME ZONE);
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 24:1: select CAST(time(fileman)'010101'AS VARCHAR);
                       ^^^^^^^^^^^^^
OCTO> select CAST(time(fileman)'010101'AS VARCHAR);
OCTO> select CAST(timestamp(fileman)'3230101.010101'AS DATE);
DATE
2023-01-01
(1 row)
OCTO> select CAST(timestamp(fileman)'3230101.010101'AS TIME);
TIME
01:01:01
(1 row)
OCTO> select CAST(timestamp(fileman)'3230101.010101'AS TIMESTAMP);
TIMESTAMP
2023-01-01 01:01:01
(1 row)
OCTO> select CAST(timestamp(fileman)'3230101.010101'AS TIMESTAMP WITH TIME ZONE);
TIMESTAMPTZ
2023-01-01 01:01:01-05
(1 row)
OCTO> select CAST(timestamp(fileman)'3230101.010101'AS VARCHAR);
VARCHAR
2023-01-01 01:01:01
(1 row)
OCTO> select timestamp(fileman)'3230101.010101'::time < time'01:02:01';
???
t
(1 row)
OCTO> -- Should return `true`
select timestamp(fileman)'3230101.010101'::date < date'2023-01-02';
???
t
(1 row)
OCTO> -- Should return `true`
select (timestamp(fileman)'3230101.010101'::date)::varchar ='2023-01-01';
???
t
(1 row)
OCTO> -- Should return `true`
select (timestamp(fileman)'3230101.010101'::date) ='2023-01-01'::date;
???
t
(1 row)
OCTO> -- Should return `true`

select date(fileman)'3230101'::VARCHAR(2);
VARCHAR
20
(1 row)
OCTO> select date(fileman)'3230101'::VARCHAR(3);
VARCHAR
202
(1 row)
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 39:1: select time(fileman)'010101'::VARCHAR(3);
                  ^^^^^^^^^^^^^
OCTO> select time(fileman)'010101'::VARCHAR(3);
OCTO> select timestamp(fileman)'3230101.010101'::VARCHAR(3);
VARCHAR
202
(1 row)
OCTO> 
# ----------------------------------------------------------------------------
# Include generated M code in reference file to verify all optimizations there
# ----------------------------------------------------------------------------
;; This is a generated file; do not modify. Generated M code corresponds to below SQL query
;; ---------------------------------------------------------
;  select timestamp(fileman)'3230101.010101'::time < time'01:02:01';
;; ---------------------------------------------------------

octoPlan0(cursorId,wrapInTp)
    NEW %ydboctop,%ydboctoexpr
    TSTART:wrapInTp ():(serial)
    DO octoPlan1(cursorId)
    TCOMMIT:wrapInTp
    QUIT

octoPlan1(cursorId)
    NEW %ydboctoz,%ydboctoexpr KILL %ydboctocursor(cursorId,"keys",3,"","")
    SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=""
    FOR  SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=$ORDER(^%ydboctoocto("tables","octoOneRow",%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id"))) QUIT:(%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")="")  DO
    . SET %ydboctoexpr=1
    . DO:%ydboctoexpr
    . . SET:1&$INCREMENT(%ydboctocursor(cursorId,"keys",3,"","")) %ydboctoz=42
    . . SET %ydboctoexpr=$$Fileman2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",1)),20)
    . . SET %ydboctoexpr=$$DateTimeCast^%ydboctoplanhelpers((%ydboctoexpr),20,7)
    . . SET %ydboctoexpr(1)=%ydboctoexpr
    . . SET %ydboctoexpr=$$Text2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",2)),18,"%H:%M:%S")
    . . SET %ydboctoexpr=%ydboctoexpr(1)<%ydboctoexpr
    . . SET %ydboctoexpr=$select((1=%ydboctoexpr):"t",(0=%ydboctoexpr):"f",1:$ZYSQLNULL)
    . . SET %ydboctoexpr=$$str2mval^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctocursor(cursorId,"keys",3,"","",%ydboctocursor(cursorId,"keys",3,"",""))=%ydboctoexpr
    ZKILL %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")
    QUIT
;; This is a generated file; do not modify. Generated M code corresponds to below SQL query
;; ---------------------------------------------------------
;  -- Should return `true`
;  
;  select date(fileman)'3230101'::VARCHAR(2);
;; ---------------------------------------------------------

octoPlan0(cursorId,wrapInTp)
    NEW %ydboctop,%ydboctoexpr
    TSTART:wrapInTp ():(serial)
    DO octoPlan1(cursorId)
    TCOMMIT:wrapInTp
    QUIT

octoPlan1(cursorId)
    NEW %ydboctoz,%ydboctoexpr KILL %ydboctocursor(cursorId,"keys",3,"","")
    SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=""
    FOR  SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=$ORDER(^%ydboctoocto("tables","octoOneRow",%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id"))) QUIT:(%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")="")  DO
    . SET %ydboctoexpr=1
    . DO:%ydboctoexpr
    . . SET:1&$INCREMENT(%ydboctocursor(cursorId,"keys",3,"","")) %ydboctoz=42
    . . SET %ydboctoexpr=$$Fileman2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",1)),17)
    . . SET %ydboctoexpr=$$Cast2VARCHAR^%ydboctoplanhelpers($$PrintDateTimeResultColumnValue^%ydboctoplanhelpers((%ydboctoexpr),17,%ydboctodatetimeoutputformat,"%Y-%m-%d"),$GET(%ydboctocursor(cursorId,"parameters",2)))
    . . SET %ydboctoexpr=$$str2mval^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctocursor(cursorId,"keys",3,"","",%ydboctocursor(cursorId,"keys",3,"",""))=%ydboctoexpr
    ZKILL %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")
    QUIT
;; This is a generated file; do not modify. Generated M code corresponds to below SQL query
;; ---------------------------------------------------------
;  select timestamp(fileman)'3230101.010101'::TIME;
;; ---------------------------------------------------------

octoPlan0(cursorId,wrapInTp)
    NEW %ydboctop,%ydboctoexpr
    TSTART:wrapInTp ():(serial)
    DO octoPlan1(cursorId)
    TCOMMIT:wrapInTp
    QUIT

octoPlan1(cursorId)
    NEW %ydboctoz,%ydboctoexpr KILL %ydboctocursor(cursorId,"keys",3,"","")
    SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=""
    FOR  SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=$ORDER(^%ydboctoocto("tables","octoOneRow",%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id"))) QUIT:(%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")="")  DO
    . SET %ydboctoexpr=1
    . DO:%ydboctoexpr
    . . SET:1&$INCREMENT(%ydboctocursor(cursorId,"keys",3,"","")) %ydboctoz=42
    . . SET %ydboctoexpr=$$Fileman2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",1)),20)
    . . SET %ydboctoexpr=$$DateTimeCast^%ydboctoplanhelpers((%ydboctoexpr),20,7)
    . . SET %ydboctoexpr=$$PrintDateTimeResultColumnValue^%ydboctoplanhelpers(%ydboctoexpr,18,%ydboctodatetimeoutputformat,"%H:%M:%S")
    . . SET %ydboctoexpr=$$str2mval^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctocursor(cursorId,"keys",3,"","",%ydboctocursor(cursorId,"keys",3,"",""))=%ydboctoexpr
    ZKILL %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")
    QUIT
;; This is a generated file; do not modify. Generated M code corresponds to below SQL query
;; ---------------------------------------------------------
;  select date(fileman)'3230101'::TIMESTAMP WITH TIME ZONE;
;; ---------------------------------------------------------

octoPlan0(cursorId,wrapInTp)
    NEW %ydboctop,%ydboctoexpr
    TSTART:wrapInTp ():(serial)
    DO octoPlan1(cursorId)
    TCOMMIT:wrapInTp
    QUIT

octoPlan1(cursorId)
    NEW %ydboctoz,%ydboctoexpr KILL %ydboctocursor(cursorId,"keys",3,"","")
    SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=""
    FOR  SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=$ORDER(^%ydboctoocto("tables","octoOneRow",%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id"))) QUIT:(%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")="")  DO
    . SET %ydboctoexpr=1
    . DO:%ydboctoexpr
    . . SET:1&$INCREMENT(%ydboctocursor(cursorId,"keys",3,"","")) %ydboctoz=42
    . . SET %ydboctoexpr=$$Fileman2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",1)),17)
    . . SET %ydboctoexpr=$$DateTimeCast^%ydboctoplanhelpers((%ydboctoexpr),17,10)
    . . SET %ydboctoexpr=$$PrintDateTimeResultColumnValue^%ydboctoplanhelpers(%ydboctoexpr,21,%ydboctodatetimeoutputformat,"%Y-%m-%d %H:%M:%S%z")
    . . SET %ydboctoexpr=$$str2mval^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctocursor(cursorId,"keys",3,"","",%ydboctocursor(cursorId,"keys",3,"",""))=%ydboctoexpr
    ZKILL %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")
    QUIT
;; This is a generated file; do not modify. Generated M code corresponds to below SQL query
;; ---------------------------------------------------------
;  -- Should return `true`
;  select (timestamp(fileman)'3230101.010101'::date) ='2023-01-01'::date;
;; ---------------------------------------------------------

octoPlan0(cursorId,wrapInTp)
    NEW %ydboctop,%ydboctoexpr
    TSTART:wrapInTp ():(serial)
    DO octoPlan1(cursorId)
    TCOMMIT:wrapInTp
    QUIT

octoPlan1(cursorId)
    NEW %ydboctoz,%ydboctoexpr KILL %ydboctocursor(cursorId,"keys",3,"","")
    SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=""
    FOR  SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=$ORDER(^%ydboctoocto("tables","octoOneRow",%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id"))) QUIT:(%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")="")  DO
    . SET %ydboctoexpr=1
    . DO:%ydboctoexpr
    . . SET:1&$INCREMENT(%ydboctocursor(cursorId,"keys",3,"","")) %ydboctoz=42
    . . SET %ydboctoexpr=$$Fileman2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",1)),20)
    . . SET %ydboctoexpr=$$DateTimeCast^%ydboctoplanhelpers((%ydboctoexpr),20,6)
    . . SET %ydboctoexpr(1)=$$ForceNumeric^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctoexpr=$GET(%ydboctocursor(cursorId,"parameters",2))
    . . SET %ydboctoexpr=$$String2DateTimeCast^%ydboctoplanhelpers((%ydboctoexpr),"%Y-%m-%d",6)
    . . SET %ydboctoexpr=$$ForceNumeric^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctoexpr=%ydboctoexpr(1)=%ydboctoexpr
    . . SET %ydboctoexpr=$select((1=%ydboctoexpr):"t",(0=%ydboctoexpr):"f",1:$ZYSQLNULL)
    . . SET %ydboctoexpr=$$str2mval^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctocursor(cursorId,"keys",3,"","",%ydboctocursor(cursorId,"keys",3,"",""))=%ydboctoexpr
    ZKILL %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")
    QUIT
;; This is a generated file; do not modify. Generated M code corresponds to below SQL query
;; ---------------------------------------------------------
;  select timestamp(fileman)'3230101.010101'::TIMESTAMP;
;; ---------------------------------------------------------

octoPlan0(cursorId,wrapInTp)
    NEW %ydboctop,%ydboctoexpr
    TSTART:wrapInTp ():(serial)
    DO octoPlan1(cursorId)
    TCOMMIT:wrapInTp
    QUIT

octoPlan1(cursorId)
    NEW %ydboctoz,%ydboctoexpr KILL %ydboctocursor(cursorId,"keys",3,"","")
    SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=""
    FOR  SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=$ORDER(^%ydboctoocto("tables","octoOneRow",%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id"))) QUIT:(%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")="")  DO
    . SET %ydboctoexpr=1
    . DO:%ydboctoexpr
    . . SET:1&$INCREMENT(%ydboctocursor(cursorId,"keys",3,"","")) %ydboctoz=42
    . . SET %ydboctoexpr=$$Fileman2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",1)),20)
    . . SET %ydboctoexpr=$$DateTimeCast^%ydboctoplanhelpers((%ydboctoexpr),20,9)
    . . SET %ydboctoexpr=$$PrintDateTimeResultColumnValue^%ydboctoplanhelpers(%ydboctoexpr,20,%ydboctodatetimeoutputformat,"%Y-%m-%d %H:%M:%S")
    . . SET %ydboctoexpr=$$str2mval^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctocursor(cursorId,"keys",3,"","",%ydboctocursor(cursorId,"keys",3,"",""))=%ydboctoexpr
    ZKILL %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")
    QUIT
;; This is a generated file; do not modify. Generated M code corresponds to below SQL query
;; ---------------------------------------------------------
;  select timestamp(fileman)'3230101.010101'::DATE;
;; ---------------------------------------------------------

octoPlan0(cursorId,wrapInTp)
    NEW %ydboctop,%ydboctoexpr
    TSTART:wrapInTp ():(serial)
    DO octoPlan1(cursorId)
    TCOMMIT:wrapInTp
    QUIT

octoPlan1(cursorId)
    NEW %ydboctoz,%ydboctoexpr KILL %ydboctocursor(cursorId,"keys",3,"","")
    SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=""
    FOR  SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=$ORDER(^%ydboctoocto("tables","octoOneRow",%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id"))) QUIT:(%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")="")  DO
    . SET %ydboctoexpr=1
    . DO:%ydboctoexpr
    . . SET:1&$INCREMENT(%ydboctocursor(cursorId,"keys",3,"","")) %ydboctoz=42
    . . SET %ydboctoexpr=$$Fileman2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",1)),20)
    . . SET %ydboctoexpr=$$DateTimeCast^%ydboctoplanhelpers((%ydboctoexpr),20,6)
    . . SET %ydboctoexpr=$$PrintDateTimeResultColumnValue^%ydboctoplanhelpers(%ydboctoexpr,17,%ydboctodatetimeoutputformat,"%Y-%m-%d")
    . . SET %ydboctoexpr=$$str2mval^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctocursor(cursorId,"keys",3,"","",%ydboctocursor(cursorId,"keys",3,"",""))=%ydboctoexpr
    ZKILL %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")
    QUIT
;; This is a generated file; do not modify. Generated M code corresponds to below SQL query
;; ---------------------------------------------------------
;  select date(fileman)'3230101'::DATE;
;; ---------------------------------------------------------

octoPlan0(cursorId,wrapInTp)
    NEW %ydboctop,%ydboctoexpr
    TSTART:wrapInTp ():(serial)
    DO octoPlan1(cursorId)
    TCOMMIT:wrapInTp
    QUIT

octoPlan1(cursorId)
    NEW %ydboctoz,%ydboctoexpr KILL %ydboctocursor(cursorId,"keys",3,"","")
    SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=""
    FOR  SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=$ORDER(^%ydboctoocto("tables","octoOneRow",%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id"))) QUIT:(%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")="")  DO
    . SET %ydboctoexpr=1
    . DO:%ydboctoexpr
    . . SET:1&$INCREMENT(%ydboctocursor(cursorId,"keys",3,"","")) %ydboctoz=42
    . . SET %ydboctoexpr=$$Fileman2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",1)),17)
    . . SET %ydboctoexpr=$$DateTimeCast^%ydboctoplanhelpers((%ydboctoexpr),17,6)
    . . SET %ydboctoexpr=$$PrintDateTimeResultColumnValue^%ydboctoplanhelpers(%ydboctoexpr,17,%ydboctodatetimeoutputformat,"%Y-%m-%d")
    . . SET %ydboctoexpr=$$str2mval^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctocursor(cursorId,"keys",3,"","",%ydboctocursor(cursorId,"keys",3,"",""))=%ydboctoexpr
    ZKILL %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")
    QUIT
;; This is a generated file; do not modify. Generated M code corresponds to below SQL query
;; ---------------------------------------------------------
;  select timestamp(fileman)'3230101.010101'::VARCHAR;
;; ---------------------------------------------------------

octoPlan0(cursorId,wrapInTp)
    NEW %ydboctop,%ydboctoexpr
    TSTART:wrapInTp ():(serial)
    DO octoPlan1(cursorId)
    TCOMMIT:wrapInTp
    QUIT

octoPlan1(cursorId)
    NEW %ydboctoz,%ydboctoexpr KILL %ydboctocursor(cursorId,"keys",3,"","")
    SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=""
    FOR  SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=$ORDER(^%ydboctoocto("tables","octoOneRow",%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id"))) QUIT:(%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")="")  DO
    . SET %ydboctoexpr=1
    . DO:%ydboctoexpr
    . . SET:1&$INCREMENT(%ydboctocursor(cursorId,"keys",3,"","")) %ydboctoz=42
    . . SET %ydboctoexpr=$$Fileman2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",1)),20)
    . . SET %ydboctoexpr=$$PrintDateTimeResultColumnValue^%ydboctoplanhelpers((%ydboctoexpr),20,%ydboctodatetimeoutputformat,"%Y-%m-%d %H:%M:%S")
    . . SET %ydboctoexpr=$$str2mval^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctocursor(cursorId,"keys",3,"","",%ydboctocursor(cursorId,"keys",3,"",""))=%ydboctoexpr
    ZKILL %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")
    QUIT
;; This is a generated file; do not modify. Generated M code corresponds to below SQL query
;; ---------------------------------------------------------
;  select timestamp(fileman)'3230101.010101'::TIMESTAMP WITH TIME ZONE;
;; ---------------------------------------------------------

octoPlan0(cursorId,wrapInTp)
    NEW %ydboctop,%ydboctoexpr
    TSTART:wrapInTp ():(serial)
    DO octoPlan1(cursorId)
    TCOMMIT:wrapInTp
    QUIT

octoPlan1(cursorId)
    NEW %ydboctoz,%ydboctoexpr KILL %ydboctocursor(cursorId,"keys",3,"","")
    SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=""
    FOR  SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=$ORDER(^%ydboctoocto("tables","octoOneRow",%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id"))) QUIT:(%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")="")  DO
    . SET %ydboctoexpr=1
    . DO:%ydboctoexpr
    . . SET:1&$INCREMENT(%ydboctocursor(cursorId,"keys",3,"","")) %ydboctoz=42
    . . SET %ydboctoexpr=$$Fileman2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",1)),20)
    . . SET %ydboctoexpr=$$DateTimeCast^%ydboctoplanhelpers((%ydboctoexpr),20,10)
    . . SET %ydboctoexpr=$$PrintDateTimeResultColumnValue^%ydboctoplanhelpers(%ydboctoexpr,21,%ydboctodatetimeoutputformat,"%Y-%m-%d %H:%M:%S%z")
    . . SET %ydboctoexpr=$$str2mval^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctocursor(cursorId,"keys",3,"","",%ydboctocursor(cursorId,"keys",3,"",""))=%ydboctoexpr
    ZKILL %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")
    QUIT
;; This is a generated file; do not modify. Generated M code corresponds to below SQL query
;; ---------------------------------------------------------
;  select timestamp(fileman)'3230101.010101'::VARCHAR(3);
;; ---------------------------------------------------------

octoPlan0(cursorId,wrapInTp)
    NEW %ydboctop,%ydboctoexpr
    TSTART:wrapInTp ():(serial)
    DO octoPlan1(cursorId)
    TCOMMIT:wrapInTp
    QUIT

octoPlan1(cursorId)
    NEW %ydboctoz,%ydboctoexpr KILL %ydboctocursor(cursorId,"keys",3,"","")
    SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=""
    FOR  SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=$ORDER(^%ydboctoocto("tables","octoOneRow",%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id"))) QUIT:(%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")="")  DO
    . SET %ydboctoexpr=1
    . DO:%ydboctoexpr
    . . SET:1&$INCREMENT(%ydboctocursor(cursorId,"keys",3,"","")) %ydboctoz=42
    . . SET %ydboctoexpr=$$Fileman2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",1)),20)
    . . SET %ydboctoexpr=$$Cast2VARCHAR^%ydboctoplanhelpers($$PrintDateTimeResultColumnValue^%ydboctoplanhelpers((%ydboctoexpr),20,%ydboctodatetimeoutputformat,"%Y-%m-%d %H:%M:%S"),$GET(%ydboctocursor(cursorId,"parameters",2)))
    . . SET %ydboctoexpr=$$str2mval^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctocursor(cursorId,"keys",3,"","",%ydboctocursor(cursorId,"keys",3,"",""))=%ydboctoexpr
    ZKILL %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")
    QUIT
;; This is a generated file; do not modify. Generated M code corresponds to below SQL query
;; ---------------------------------------------------------
;  select date(fileman)'3230101'::TIMESTAMP;
;; ---------------------------------------------------------

octoPlan0(cursorId,wrapInTp)
    NEW %ydboctop,%ydboctoexpr
    TSTART:wrapInTp ():(serial)
    DO octoPlan1(cursorId)
    TCOMMIT:wrapInTp
    QUIT

octoPlan1(cursorId)
    NEW %ydboctoz,%ydboctoexpr KILL %ydboctocursor(cursorId,"keys",3,"","")
    SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=""
    FOR  SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=$ORDER(^%ydboctoocto("tables","octoOneRow",%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id"))) QUIT:(%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")="")  DO
    . SET %ydboctoexpr=1
    . DO:%ydboctoexpr
    . . SET:1&$INCREMENT(%ydboctocursor(cursorId,"keys",3,"","")) %ydboctoz=42
    . . SET %ydboctoexpr=$$Fileman2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",1)),17)
    . . SET %ydboctoexpr=$$DateTimeCast^%ydboctoplanhelpers((%ydboctoexpr),17,9)
    . . SET %ydboctoexpr=$$PrintDateTimeResultColumnValue^%ydboctoplanhelpers(%ydboctoexpr,20,%ydboctodatetimeoutputformat,"%Y-%m-%d %H:%M:%S")
    . . SET %ydboctoexpr=$$str2mval^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctocursor(cursorId,"keys",3,"","",%ydboctocursor(cursorId,"keys",3,"",""))=%ydboctoexpr
    ZKILL %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")
    QUIT
;; This is a generated file; do not modify. Generated M code corresponds to below SQL query
;; ---------------------------------------------------------
;  select date(fileman)'3230101'::VARCHAR;
;; ---------------------------------------------------------

octoPlan0(cursorId,wrapInTp)
    NEW %ydboctop,%ydboctoexpr
    TSTART:wrapInTp ():(serial)
    DO octoPlan1(cursorId)
    TCOMMIT:wrapInTp
    QUIT

octoPlan1(cursorId)
    NEW %ydboctoz,%ydboctoexpr KILL %ydboctocursor(cursorId,"keys",3,"","")
    SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=""
    FOR  SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=$ORDER(^%ydboctoocto("tables","octoOneRow",%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id"))) QUIT:(%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")="")  DO
    . SET %ydboctoexpr=1
    . DO:%ydboctoexpr
    . . SET:1&$INCREMENT(%ydboctocursor(cursorId,"keys",3,"","")) %ydboctoz=42
    . . SET %ydboctoexpr=$$Fileman2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",1)),17)
    . . SET %ydboctoexpr=$$PrintDateTimeResultColumnValue^%ydboctoplanhelpers((%ydboctoexpr),17,%ydboctodatetimeoutputformat,"%Y-%m-%d")
    . . SET %ydboctoexpr=$$str2mval^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctocursor(cursorId,"keys",3,"","",%ydboctocursor(cursorId,"keys",3,"",""))=%ydboctoexpr
    ZKILL %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")
    QUIT
;; This is a generated file; do not modify. Generated M code corresponds to below SQL query
;; ---------------------------------------------------------
;  -- Should return `true`
;  select (timestamp(fileman)'3230101.010101'::date)::varchar ='2023-01-01';
;; ---------------------------------------------------------

octoPlan0(cursorId,wrapInTp)
    NEW %ydboctop,%ydboctoexpr
    TSTART:wrapInTp ():(serial)
    DO octoPlan1(cursorId)
    TCOMMIT:wrapInTp
    QUIT

octoPlan1(cursorId)
    NEW %ydboctoz,%ydboctoexpr KILL %ydboctocursor(cursorId,"keys",3,"","")
    SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=""
    FOR  SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=$ORDER(^%ydboctoocto("tables","octoOneRow",%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id"))) QUIT:(%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")="")  DO
    . SET %ydboctoexpr=1
    . DO:%ydboctoexpr
    . . SET:1&$INCREMENT(%ydboctocursor(cursorId,"keys",3,"","")) %ydboctoz=42
    . . SET %ydboctoexpr=$$Fileman2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",1)),20)
    . . SET %ydboctoexpr=$$DateTimeCast^%ydboctoplanhelpers((%ydboctoexpr),20,6)
    . . SET %ydboctoexpr=$$PrintDateTimeResultColumnValue^%ydboctoplanhelpers((%ydboctoexpr),17,%ydboctodatetimeoutputformat,"%Y-%m-%d")
    . . SET %ydboctoexpr(1)=%ydboctoexpr
    . . SET %ydboctoexpr=$GET(%ydboctocursor(cursorId,"parameters",2))
    . . SET %ydboctoexpr=%ydboctoexpr(1)=%ydboctoexpr
    . . SET %ydboctoexpr=$select((1=%ydboctoexpr):"t",(0=%ydboctoexpr):"f",1:$ZYSQLNULL)
    . . SET %ydboctoexpr=$$str2mval^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctocursor(cursorId,"keys",3,"","",%ydboctocursor(cursorId,"keys",3,"",""))=%ydboctoexpr
    ZKILL %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")
    QUIT
;; This is a generated file; do not modify. Generated M code corresponds to below SQL query
;; ---------------------------------------------------------
;  -- Should return `true`
;  select timestamp(fileman)'3230101.010101'::date < date'2023-01-02';
;; ---------------------------------------------------------

octoPlan0(cursorId,wrapInTp)
    NEW %ydboctop,%ydboctoexpr
    TSTART:wrapInTp ():(serial)
    DO octoPlan1(cursorId)
    TCOMMIT:wrapInTp
    QUIT

octoPlan1(cursorId)
    NEW %ydboctoz,%ydboctoexpr KILL %ydboctocursor(cursorId,"keys",3,"","")
    SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=""
    FOR  SET %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")=$ORDER(^%ydboctoocto("tables","octoOneRow",%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id"))) QUIT:(%ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")="")  DO
    . SET %ydboctoexpr=1
    . DO:%ydboctoexpr
    . . SET:1&$INCREMENT(%ydboctocursor(cursorId,"keys",3,"","")) %ydboctoz=42
    . . SET %ydboctoexpr=$$Fileman2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",1)),20)
    . . SET %ydboctoexpr=$$DateTimeCast^%ydboctoplanhelpers((%ydboctoexpr),20,6)
    . . SET %ydboctoexpr(1)=%ydboctoexpr
    . . SET %ydboctoexpr=$$Text2UnixTime^%ydboctoplanhelpers($GET(%ydboctocursor(cursorId,"parameters",2)),17,"%Y-%m-%d")
    . . SET %ydboctoexpr=%ydboctoexpr(1)<%ydboctoexpr
    . . SET %ydboctoexpr=$select((1=%ydboctoexpr):"t",(0=%ydboctoexpr):"f",1:$ZYSQLNULL)
    . . SET %ydboctoexpr=$$str2mval^%ydboctoplanhelpers(%ydboctoexpr)
    . . SET %ydboctocursor(cursorId,"keys",3,"","",%ydboctocursor(cursorId,"keys",3,"",""))=%ydboctoexpr
    ZKILL %ydboctocursor(cursorId,"keys",1,"octoonerowtable","id")
    QUIT

select date(fileman)'3230101'::DATE;
select date(fileman)'3230101'::TIMESTAMP;
select date(fileman)'3230101'::TIMESTAMP WITH TIME ZONE;
select date(fileman)'3230101'::VARCHAR;

select time(fileman)'010101'::TIME;
select time(fileman)'010101'::TIME WITH TIME ZONE;
select time(fileman)'010101'::VARCHAR;

select timestamp(fileman)'3230101.010101'::DATE;
select timestamp(fileman)'3230101.010101'::TIME;
select timestamp(fileman)'3230101.010101'::TIMESTAMP;
select timestamp(fileman)'3230101.010101'::TIMESTAMP WITH TIME ZONE;
select timestamp(fileman)'3230101.010101'::VARCHAR;

select CAST(date(fileman)'3230101'AS DATE);
select CAST(date(fileman)'3230101'AS TIMESTAMP);
select CAST(date(fileman)'3230101'AS TIMESTAMP WITH TIME ZONE);
select CAST(date(fileman)'3230101'AS VARCHAR);

select CAST(time(fileman)'010101'AS TIME);
select CAST(time(fileman)'010101'AS TIME WITH TIME ZONE);
select CAST(time(fileman)'010101'AS VARCHAR);

select CAST(timestamp(fileman)'3230101.010101'AS DATE);
select CAST(timestamp(fileman)'3230101.010101'AS TIME);
select CAST(timestamp(fileman)'3230101.010101'AS TIMESTAMP);
select CAST(timestamp(fileman)'3230101.010101'AS TIMESTAMP WITH TIME ZONE);
select CAST(timestamp(fileman)'3230101.010101'AS VARCHAR);

-- More detailed tests
select timestamp(fileman)'3230101.010101'::time < time'01:02:01'; -- Should return `true`
select timestamp(fileman)'3230101.010101'::date < date'2023-01-02'; -- Should return `true`
select (timestamp(fileman)'3230101.010101'::date)::varchar ='2023-01-01'; -- Should return `true`
select (timestamp(fileman)'3230101.010101'::date) ='2023-01-01'::date; -- Should return `true`

select date(fileman)'3230101'::VARCHAR(2);
select date(fileman)'3230101'::VARCHAR(3);
select time(fileman)'010101'::VARCHAR(3);
select timestamp(fileman)'3230101.010101'::VARCHAR(3);

OCTO> select date(fileman)'3230101'::DATE;
DATE
66475
(1 row)
OCTO> select date(fileman)'3230101'::TIMESTAMP;
TIMESTAMP
66475,0
(1 row)
OCTO> select date(fileman)'3230101'::TIMESTAMP WITH TIME ZONE;
TIMESTAMPTZ
66475,0
(1 row)
OCTO> select date(fileman)'3230101'::VARCHAR;
VARCHAR
66475
(1 row)
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 7:1: select time(fileman)'010101'::TIME;
                 ^^^^^^^^^^^^^
OCTO> select time(fileman)'010101'::TIME;
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 8:1: select time(fileman)'010101'::TIME WITH TIME ZONE;
                 ^^^^^^^^^^^^^
OCTO> select time(fileman)'010101'::TIME WITH TIME ZONE;
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 9:1: select time(fileman)'010101'::VARCHAR;
                 ^^^^^^^^^^^^^
OCTO> select time(fileman)'010101'::VARCHAR;
OCTO> select timestamp(fileman)'3230101.010101'::DATE;
DATE
66475
(1 row)
OCTO> select timestamp(fileman)'3230101.010101'::TIME;
TIME
3661
(1 row)
OCTO> select timestamp(fileman)'3230101.010101'::TIMESTAMP;
TIMESTAMP
66475,3661
(1 row)
OCTO> select timestamp(fileman)'3230101.010101'::TIMESTAMP WITH TIME ZONE;
TIMESTAMPTZ
66475,3661
(1 row)
OCTO> select timestamp(fileman)'3230101.010101'::VARCHAR;
VARCHAR
66475,3661
(1 row)
OCTO> select CAST(date(fileman)'3230101'AS DATE);
DATE
66475
(1 row)
OCTO> select CAST(date(fileman)'3230101'AS TIMESTAMP);
TIMESTAMP
66475,0
(1 row)
OCTO> select CAST(date(fileman)'3230101'AS TIMESTAMP WITH TIME ZONE);
TIMESTAMPTZ
66475,0
(1 row)
OCTO> select CAST(date(fileman)'3230101'AS VARCHAR);
VARCHAR
66475
(1 row)
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 22:1: select CAST(time(fileman)'010101'AS TIME);
                       ^^^^^^^^^^^^^
OCTO> select CAST(time(fileman)'010101'AS TIME);
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 23:1: select CAST(time(fileman)'010101'AS TIME WITH TIME ZONE);
                       ^^^^^^^^^^^^^
OCTO> select CAST(time(fileman)'010101'AS TIME WITH TIME ZONE);
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 24:1: select CAST(time(fileman)'010101'AS VARCHAR);
                       ^^^^^^^^^^^^^
OCTO> select CAST(time(fileman)'010101'AS VARCHAR);
OCTO> select CAST(timestamp(fileman)'3230101.010101'AS DATE);
DATE
66475
(1 row)
OCTO> select CAST(timestamp(fileman)'3230101.010101'AS TIME);
TIME
3661
(1 row)
OCTO> select CAST(timestamp(fileman)'3230101.010101'AS TIMESTAMP);
TIMESTAMP
66475,3661
(1 row)
OCTO> select CAST(timestamp(fileman)'3230101.010101'AS TIMESTAMP WITH TIME ZONE);
TIMESTAMPTZ
66475,3661
(1 row)
OCTO> select CAST(timestamp(fileman)'3230101.010101'AS VARCHAR);
VARCHAR
66475,3661
(1 row)
OCTO> select timestamp(fileman)'3230101.010101'::time < time'01:02:01';
???
t
(1 row)
OCTO> -- Should return `true`
select timestamp(fileman)'3230101.010101'::date < date'2023-01-02';
???
t
(1 row)
OCTO> -- Should return `true`
select (timestamp(fileman)'3230101.010101'::date)::varchar ='2023-01-01';
???
f
(1 row)
OCTO> -- Should return `true`
select (timestamp(fileman)'3230101.010101'::date) ='2023-01-01'::date;
???
t
(1 row)
OCTO> -- Should return `true`

select date(fileman)'3230101'::VARCHAR(2);
VARCHAR
66
(1 row)
OCTO> select date(fileman)'3230101'::VARCHAR(3);
VARCHAR
664
(1 row)
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 39:1: select time(fileman)'010101'::VARCHAR(3);
                  ^^^^^^^^^^^^^
OCTO> select time(fileman)'010101'::VARCHAR(3);
OCTO> select timestamp(fileman)'3230101.010101'::VARCHAR(3);
VARCHAR
664
(1 row)
OCTO> 

select date(fileman)'3230101'::DATE;
select date(fileman)'3230101'::TIMESTAMP;
select date(fileman)'3230101'::TIMESTAMP WITH TIME ZONE;
select date(fileman)'3230101'::VARCHAR;

select time(fileman)'010101'::TIME;
select time(fileman)'010101'::TIME WITH TIME ZONE;
select time(fileman)'010101'::VARCHAR;

select timestamp(fileman)'3230101.010101'::DATE;
select timestamp(fileman)'3230101.010101'::TIME;
select timestamp(fileman)'3230101.010101'::TIMESTAMP;
select timestamp(fileman)'3230101.010101'::TIMESTAMP WITH TIME ZONE;
select timestamp(fileman)'3230101.010101'::VARCHAR;

select CAST(date(fileman)'3230101'AS DATE);
select CAST(date(fileman)'3230101'AS TIMESTAMP);
select CAST(date(fileman)'3230101'AS TIMESTAMP WITH TIME ZONE);
select CAST(date(fileman)'3230101'AS VARCHAR);

select CAST(time(fileman)'010101'AS TIME);
select CAST(time(fileman)'010101'AS TIME WITH TIME ZONE);
select CAST(time(fileman)'010101'AS VARCHAR);

select CAST(timestamp(fileman)'3230101.010101'AS DATE);
select CAST(timestamp(fileman)'3230101.010101'AS TIME);
select CAST(timestamp(fileman)'3230101.010101'AS TIMESTAMP);
select CAST(timestamp(fileman)'3230101.010101'AS TIMESTAMP WITH TIME ZONE);
select CAST(timestamp(fileman)'3230101.010101'AS VARCHAR);

-- More detailed tests
select timestamp(fileman)'3230101.010101'::time < time'01:02:01'; -- Should return `true`
select timestamp(fileman)'3230101.010101'::date < date'2023-01-02'; -- Should return `true`
select (timestamp(fileman)'3230101.010101'::date)::varchar ='2023-01-01'; -- Should return `true`
select (timestamp(fileman)'3230101.010101'::date) ='2023-01-01'::date; -- Should return `true`

select date(fileman)'3230101'::VARCHAR(2);
select date(fileman)'3230101'::VARCHAR(3);
select time(fileman)'010101'::VARCHAR(3);
select timestamp(fileman)'3230101.010101'::VARCHAR(3);

OCTO> select date(fileman)'3230101'::DATE;
DATE
3230101
(1 row)
OCTO> select date(fileman)'3230101'::TIMESTAMP;
TIMESTAMP
3230101.000000
(1 row)
OCTO> select date(fileman)'3230101'::TIMESTAMP WITH TIME ZONE;
TIMESTAMPTZ
3230101.000000
(1 row)
OCTO> select date(fileman)'3230101'::VARCHAR;
VARCHAR
3230101
(1 row)
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 7:1: select time(fileman)'010101'::TIME;
                 ^^^^^^^^^^^^^
OCTO> select time(fileman)'010101'::TIME;
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 8:1: select time(fileman)'010101'::TIME WITH TIME ZONE;
                 ^^^^^^^^^^^^^
OCTO> select time(fileman)'010101'::TIME WITH TIME ZONE;
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 9:1: select time(fileman)'010101'::VARCHAR;
                 ^^^^^^^^^^^^^
OCTO> select time(fileman)'010101'::VARCHAR;
OCTO> select timestamp(fileman)'3230101.010101'::DATE;
DATE
3230101
(1 row)
OCTO> select timestamp(fileman)'3230101.010101'::TIME;
TIME

(1 row)
OCTO> select timestamp(fileman)'3230101.010101'::TIMESTAMP;
TIMESTAMP
3230101.010101
(1 row)
OCTO> select timestamp(fileman)'3230101.010101'::TIMESTAMP WITH TIME ZONE;
TIMESTAMPTZ
3230101.010101
(1 row)
OCTO> select timestamp(fileman)'3230101.010101'::VARCHAR;
VARCHAR
3230101.010101
(1 row)
OCTO> select CAST(date(fileman)'3230101'AS DATE);
DATE
3230101
(1 row)
OCTO> select CAST(date(fileman)'3230101'AS TIMESTAMP);
TIMESTAMP
3230101.000000
(1 row)
OCTO> select CAST(date(fileman)'3230101'AS TIMESTAMP WITH TIME ZONE);
TIMESTAMPTZ
3230101.000000
(1 row)
OCTO> select CAST(date(fileman)'3230101'AS VARCHAR);
VARCHAR
3230101
(1 row)
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 22:1: select CAST(time(fileman)'010101'AS TIME);
                       ^^^^^^^^^^^^^
OCTO> select CAST(time(fileman)'010101'AS TIME);
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 23:1: select CAST(time(fileman)'010101'AS TIME WITH TIME ZONE);
                       ^^^^^^^^^^^^^
OCTO> select CAST(time(fileman)'010101'AS TIME WITH TIME ZONE);
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 24:1: select CAST(time(fileman)'010101'AS VARCHAR);
                       ^^^^^^^^^^^^^
OCTO> select CAST(time(fileman)'010101'AS VARCHAR);
OCTO> select CAST(timestamp(fileman)'3230101.010101'AS DATE);
DATE
3230101
(1 row)
OCTO> select CAST(timestamp(fileman)'3230101.010101'AS TIME);
TIME

(1 row)
OCTO> select CAST(timestamp(fileman)'3230101.010101'AS TIMESTAMP);
TIMESTAMP
3230101.010101
(1 row)
OCTO> select CAST(timestamp(fileman)'3230101.010101'AS TIMESTAMP WITH TIME ZONE);
TIMESTAMPTZ
3230101.010101
(1 row)
OCTO> select CAST(timestamp(fileman)'3230101.010101'AS VARCHAR);
VARCHAR
3230101.010101
(1 row)
OCTO> select timestamp(fileman)'3230101.010101'::time < time'01:02:01';
???
t
(1 row)
OCTO> -- Should return `true`
select timestamp(fileman)'3230101.010101'::date < date'2023-01-02';
???
t
(1 row)
OCTO> -- Should return `true`
select (timestamp(fileman)'3230101.010101'::date)::varchar ='2023-01-01';
???
f
(1 row)
OCTO> -- Should return `true`
select (timestamp(fileman)'3230101.010101'::date) ='2023-01-01'::date;
???
t
(1 row)
OCTO> -- Should return `true`

select date(fileman)'3230101'::VARCHAR(2);
VARCHAR
32
(1 row)
OCTO> select date(fileman)'3230101'::VARCHAR(3);
VARCHAR
323
(1 row)
[ERROR]: ERR_INVALID_DATE_TIME_TYPE_FORMAT: The given type and format is invalid
LINE 39:1: select time(fileman)'010101'::VARCHAR(3);
                  ^^^^^^^^^^^^^
OCTO> select time(fileman)'010101'::VARCHAR(3);
OCTO> select timestamp(fileman)'3230101.010101'::VARCHAR(3);
VARCHAR
323
(1 row)
OCTO> 
