# Run [octo -vv -f TRTE10.sql > TRTE10.out]
# Verify that all 5 LP_BOOLEAN_REGEX_* plan types are generated by above queries
SQL command [select count(*) from names where firstname like 'test%';]
            LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
            LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
SQL command [select count(*) from names where firstname similar to 'test%';]
            LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
            LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
SQL command [select count(*) from names where firstname ~ 'test%';]
            LP_BOOLEAN_REGEX_SENSITIVE: 
            LP_BOOLEAN_REGEX_SENSITIVE: 
SQL command [values (1,(select 'a' like 'test%'));]
                LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
                LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
SQL command [values (1,(select 'a' similar to 'test%'));]
                LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
                LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
SQL command [values (1,(select 'a' ~ 'test_'));]
                LP_BOOLEAN_REGEX_SENSITIVE: 
                LP_BOOLEAN_REGEX_SENSITIVE: 
SQL command [(select count(*) from names where firstname like 'test%') union (select count(*) from names);]
                LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
                LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
SQL command [(select count(*) from names) intersect (select count(*) from names where firstname similar to 'test_');]
                LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
                LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
SQL command [(select count(*) from names where firstname ~ 'test%') except (select count(*) from names);]
                LP_BOOLEAN_REGEX_SENSITIVE: 
                LP_BOOLEAN_REGEX_SENSITIVE: 
SQL command [create view v1 as select * from names;]
SQL command [select count(*) from v1 where firstname like 'test%';]
            LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
            LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
SQL command [select count(*) from v1 where firstname similar to 'test%';]
            LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
            LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
SQL command [select count(*) from v1 where firstname ~ 'test%';]
            LP_BOOLEAN_REGEX_SENSITIVE: 
            LP_BOOLEAN_REGEX_SENSITIVE: 
SQL command [insert into names values (6, (select 'abcd' where 'a' like 'test%'), 'efgh');]
                          LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
                          LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
SQL command [insert into names values (7, (select 'abcd' where 'a' similar to 'test%'), 'efgh');]
                          LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
                          LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
SQL command [insert into names values (8, (select 'abcd' where 'a' ~ 'test%'), 'efgh');]
                          LP_BOOLEAN_REGEX_SENSITIVE: 
                          LP_BOOLEAN_REGEX_SENSITIVE: 
SQL command [delete from names where firstname like 'test%';]
            LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
            LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
SQL command [delete from names where firstname similar to 'test%';]
            LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
            LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
SQL command [delete from names where firstname ~ 'test%';]
            LP_BOOLEAN_REGEX_SENSITIVE: 
            LP_BOOLEAN_REGEX_SENSITIVE: 
SQL command [update names set firstname = 'a' || firstname where firstname like 'test%';]
            LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
            LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
SQL command [update names set firstname = 'a' || firstname where firstname similar to 'test%';]
            LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
            LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
SQL command [update names set firstname = 'a' || firstname where firstname ~ 'test%';]
            LP_BOOLEAN_REGEX_SENSITIVE: 
            LP_BOOLEAN_REGEX_SENSITIVE: 
SQL command [select count(*) from names where firstname != 'test%';]
SQL command [values (1,(select 'a' != 'test_'));]
SQL command [(select count(*) from names where firstname != 'test%') except (select count(*) from names where firstname != 'test_');]
SQL command [select count(*) from v1 where firstname != 'test%';]
SQL command [insert into names values (9, (select 'abcd' where 'a' != 'test%'), 'efgh');]
SQL command [delete from names where firstname != 'test%';]
SQL command [update names set firstname = 'a' || firstname where firstname != 'test%';]
SQL command [select count(*) from names where (firstname like 'test%') or (firstname not similar to 'test%');]
              LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
                LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
                LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
                  LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
SQL command [values ((select 'b' like 'test_'),(select 'a' like 'test%'));]
                LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
                LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
                LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
                LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
SQL command [(select count(*) from names where firstname ilike 'test%') union (select count(*) from names where lastname similar to 'test%');]
                LP_BOOLEAN_REGEX_INSENSITIVE_LIKE: 
                LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
                LP_BOOLEAN_REGEX_INSENSITIVE_LIKE: 
                LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
SQL command [select count(*) from v1 where firstname like 'test%' or firstname similar to 'test_';]
              LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
              LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
                LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
                LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
SQL command [insert into names values (10, (select 'abcd' where 'a' ~ 'test%'), (select 'efgh' where 'a' similar to 'test%'));]
                          LP_BOOLEAN_REGEX_SENSITIVE: 
                          LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
                          LP_BOOLEAN_REGEX_SENSITIVE: 
                          LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
SQL command [delete from names where firstname like 'test%' or firstname similar to 'test_';]
              LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
              LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
                LP_BOOLEAN_REGEX_SENSITIVE_LIKE: 
                LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
SQL command [update names set firstname = 'a' || firstname where firstname ~* 'test%' or firstname not similar to 'test%';]
              LP_BOOLEAN_REGEX_INSENSITIVE: 
                LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
                LP_BOOLEAN_REGEX_INSENSITIVE: 
                  LP_BOOLEAN_REGEX_SENSITIVE_SIMILARTO: 
SQL command []
# Verify which queries have and don't have regfreeIfAny() invocations and how many of them

_ydboctoP*.m:;  (select count(*) from names where firstname like 'test%') union (select count(*) from names);
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,1,0)

_ydboctoP*.m:;  update names set firstname = 'a' || firstname where firstname != 'test%';

_ydboctoP*.m:;  delete from names where firstname like 'test%' or firstname similar to 'test_';
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,1,0)
_ydboctoP*.m:    . . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,2,0)

_ydboctoP*.m:;  (select count(*) from names where firstname ~ 'test%') except (select count(*) from names);
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,3,0)

_ydboctoP*.m:;  delete from names where firstname similar to 'test%';
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,2,0)

_ydboctoP*.m:;  select count(*) from v1 where firstname ~ 'test%';
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,3,0)

_ydboctoP*.m:;  update names set firstname = 'a' || firstname where firstname ~ 'test%';
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,3,0)

_ydboctoP*.m:;  delete from names where firstname like 'test%';
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,1,0)

_ydboctoP*.m:;  (select count(*) from names where firstname ilike 'test%') union (select count(*) from names where lastname similar to 'test%');
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,1,2)
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,2,0)

_ydboctoP*.m:;  (select count(*) from names) intersect (select count(*) from names where firstname similar to 'test_');
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,2,0)

_ydboctoP*.m:;  (select count(*) from names where firstname != 'test%') except (select count(*) from names where firstname != 'test_');

_ydboctoP*.m:;  insert into names values (8, (select 'abcd' where 'a' ~ 'test%'), 'efgh');
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,3,0)

_ydboctoP*.m:;  update names set firstname = 'a' || firstname where firstname like 'test%';
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,1,0)

_ydboctoP*.m:;  select count(*) from names where firstname like 'test%';
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,1,0)

_ydboctoP*.m:;  select count(*) from v1 where firstname != 'test%';

_ydboctoP*.m:;  select count(*) from names where (firstname like 'test%') or (firstname not similar to 'test%');
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,1,0)
_ydboctoP*.m:    . . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(2),%ydboctoexpr,2,0)

_ydboctoP*.m:;  values ((select 'b' like 'test_'),(select 'a' like 'test%'));
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,1,0)
_ydboctoP*.m:    . . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,1,0)

_ydboctoP*.m:;  insert into names values (10, (select 'abcd' where 'a' ~ 'test%'), (select 'efgh' where 'a' similar to 'test%'));
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,2,0)
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,3,0)

_ydboctoP*.m:;  insert into names values (9, (select 'abcd' where 'a' != 'test%'), 'efgh');

_ydboctoP*.m:;  delete from names where firstname != 'test%';

_ydboctoP*.m:;  insert into names values (6, (select 'abcd' where 'a' like 'test%'), 'efgh');
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,1,0)

_ydboctoP*.m:;  update names set firstname = 'a' || firstname where firstname ~* 'test%' or firstname not similar to 'test%';
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,3,2)
_ydboctoP*.m:    . . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(2),%ydboctoexpr,2,0)

_ydboctoP*.m:;  select count(*) from v1 where firstname like 'test%';
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,1,0)

_ydboctoP*.m:;  values (1,(select 'a' similar to 'test%'));
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,2,0)

_ydboctoP*.m:;  select count(*) from v1 where firstname similar to 'test%';
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,2,0)

_ydboctoP*.m:;  values (1,(select 'a' ~ 'test_'));
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,3,0)

_ydboctoP*.m:;  select count(*) from names where firstname ~ 'test%';
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,3,0)

_ydboctoP*.m:;  values (1,(select 'a' != 'test_'));

_ydboctoP*.m:;  select count(*) from names where firstname similar to 'test%';
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,2,0)

_ydboctoP*.m:;  values (1,(select 'a' like 'test%'));
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,1,0)

_ydboctoP*.m:;  select count(*) from v1 where firstname like 'test%' or firstname similar to 'test_';
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,1,0)
_ydboctoP*.m:    . . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,2,0)

_ydboctoP*.m:;  select count(*) from names where firstname != 'test%';

_ydboctoP*.m:;  update names set firstname = 'a' || firstname where firstname similar to 'test%';
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,2,0)

_ydboctoP*.m:;  insert into names values (7, (select 'abcd' where 'a' similar to 'test%'), 'efgh');
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,2,0)

_ydboctoP*.m:;  delete from names where firstname ~ 'test%';
_ydboctoP*.m:    DO regfreeIfAny^%ydboctoplanhelpers
_ydboctoP*.m:    . SET %ydboctoexpr=$$regexmatch^%ydboctoplanhelpers(%ydboctoexpr(1),%ydboctoexpr,3,0)
