
select count(n1.id),n1.* from ((select 1 as id, 'test' as name) union (select 2 as id, 'test' as name)) as n1 group by n1.id;
select count(n1.*) from ((select 1 as id, 'test' as name) union (select 2 as id, 'test' as name)) as n1 group by count(n1.*);

-- Invalid aggregate function usage
select SUM(n1.*) from customers n1;
select MIN(n1.*) from customers n1;
select MAX(n1.*) from customers n1;
select AVG(n1.*) from customers n1;

-- Type mismatch
select n1.* = n1.firstname from names n1;
select count(n1.*) from ((select 1 as id, 'test' as name) union (select 2 as id, 'test' as name)) as n1 group by n1.* having (n1.* > 1);
select count(n1.*) from ((select 1 as id, 'test' as name) union (select 2 as id, 'test' as name)) as n1 group by n1.* having (n1.*);

-- Invalid subquery usage
select (select names.*) from names;

-- Missing FROM-clause entry
select firstname from names n1 group by names.*;
select n1.* from names n2;
select firstname from names group by n2.*;
select count(n2.*) from names;
select firstname from names order by n1.*;
select firstname from names order by count(n1.*);
select firstname from names having count(n1.*);
select firstname from names having n1.*;

-- Following query verifies that similar tablenames are not mistaken to be same
select count(DISTINCT n1.*) from names n11;

-- Invalid column correlation specification
select a,b,c from (select n1.* from names n1) as abcd(a,b,c,d);
[ERROR]: ERR_GROUP_BY_OR_AGGREGATE_FUNCTION: Column NAME must appear in the GROUP BY clause or be used in an aggregate function
[ERROR]: ERR_GROUP_BY_INVALID_USAGE: Invalid GROUP BY. Only column number, column name and expressions are valid in GROUP BY (not constants or references to subqueries or aggregate function)
LINE 1: ...n (select 2 as id, 'test' as name)) as n1 group by count(n1.*);
                                                              ^^^^^^^^^^^
[ERROR]: ERR_MISTYPED_FUNCTION_TABLE_ASTERISK: Function SUM cannot be invoked with a parameter of type TABLENAME.*
LINE 1: select SUM(n1.*) from customers n1;
               ^^^
[ERROR]: ERR_MISTYPED_FUNCTION_TABLE_ASTERISK: Function MIN cannot be invoked with a parameter of type TABLENAME.*
LINE 1: select MIN(n1.*) from customers n1;
               ^^^
[ERROR]: ERR_MISTYPED_FUNCTION_TABLE_ASTERISK: Function MAX cannot be invoked with a parameter of type TABLENAME.*
LINE 1: select MAX(n1.*) from customers n1;
               ^^^
[ERROR]: ERR_MISTYPED_FUNCTION_TABLE_ASTERISK: Function AVG cannot be invoked with a parameter of type TABLENAME.*
LINE 1: select AVG(n1.*) from customers n1;
               ^^^
[ERROR]: ERR_TYPE_MISMATCH: Type mismatch: left TABLENAME.*, right VARCHAR
LINE 1: select n1.* = n1.firstname from names n1;
               ^^
LINE 1: select n1.* = n1.firstname from names n1;
                      ^^^^^^^^^^^^
[ERROR]: ERR_TYPE_MISMATCH: Type mismatch: left TABLENAME.*, right INTEGER
LINE 1: ...2 as id, 'test' as name)) as n1 group by n1.* having (n1.* > 1);
                                                                 ^^
LINE 1: ... as id, 'test' as name)) as n1 group by n1.* having (n1.* > 1);
                                                                       ^
[ERROR]: ERR_TYPE_NOT_COMPATIBLE: Type TABLENAME.* not compatible for boolean operations
LINE 1: ...ect 2 as id, 'test' as name)) as n1 group by n1.* having (n1.*);
                                                                    ^^^^^^
[ERROR]: ERR_SUBQUERY_ONE_COLUMN: Subquery must return only one column
LINE 1: select (select names.*) from names;
               ^^^^^^^^^^^^^^^^
[ERROR]: ERR_MISSING_FROM_ENTRY: Missing FROM-clause entry for table : NAMES
LINE 1: select firstname from names n1 group by names.*;
                                                ^^^^^^^
[ERROR]: ERR_MISSING_FROM_ENTRY: Missing FROM-clause entry for table : N1
LINE 1: select n1.* from names n2;
               ^^^^
[ERROR]: ERR_MISSING_FROM_ENTRY: Missing FROM-clause entry for table : N2
LINE 1: select firstname from names group by n2.*;
                                             ^^^^
[ERROR]: ERR_MISSING_FROM_ENTRY: Missing FROM-clause entry for table : N2
LINE 1: select count(n2.*) from names;
                     ^^^^
[ERROR]: ERR_MISSING_FROM_ENTRY: Missing FROM-clause entry for table : N1
LINE 1: select firstname from names order by n1.*;
                                             ^^^^
[ERROR]: ERR_MISSING_FROM_ENTRY: Missing FROM-clause entry for table : N1
LINE 1: select firstname from names order by count(n1.*);
                                                   ^^^^
[ERROR]: ERR_GROUP_BY_OR_AGGREGATE_FUNCTION: Column FIRSTNAME must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select firstname from names order by count(n1.*);
               ^^^^^^^^^
[ERROR]: ERR_MISSING_FROM_ENTRY: Missing FROM-clause entry for table : N1
LINE 1: select firstname from names having count(n1.*);
                                                 ^^^^
[ERROR]: ERR_GROUP_BY_OR_AGGREGATE_FUNCTION: Column FIRSTNAME must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select firstname from names having count(n1.*);
               ^^^^^^^^^
[ERROR]: ERR_MISSING_FROM_ENTRY: Missing FROM-clause entry for table : N1
LINE 1: select firstname from names having n1.*;
                                           ^^^^
[ERROR]: ERR_GROUP_BY_OR_AGGREGATE_FUNCTION: Column FIRSTNAME must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select firstname from names having n1.*;
               ^^^^^^^^^
[ERROR]: ERR_MISSING_FROM_ENTRY: Missing FROM-clause entry for table : N1
LINE 1: select count(DISTINCT n1.*) from names n11;
                              ^^^^
[ERROR]: ERR_AS_MORE_COLUMNS: Table name 'ABCD' has 3 columns available but 4 columns specified
LINE 1: select a,b,c from (select n1.* from names n1) as abcd(a,b,c,d);
                                                         ^^^^
