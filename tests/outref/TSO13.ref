
-- TSO13 : OCTO440 : UNION/INTERSECT/EXCEPT does not issue column type mismatch error in some cases

--------------------------------------------------------
-- Queries that use the `names` database
--------------------------------------------------------

SELECT id, NULL, firstname FROM names UNION ALL SELECT id, firstname, NULL FROM names;
SELECT id, NULL, firstname FROM names UNION ALL SELECT id, id, NULL FROM names UNION ALL SELECT id, firstname, NULL from names;
SELECT id, id, firstname FROM names UNION ALL SELECT id, NULL, NULL FROM names UNION ALL SELECT id, firstname, NULL from names;
SELECT id, id, firstname FROM names UNION ALL SELECT id, firstname, NULL FROM names UNION ALL SELECT id, NULL, NULL from names;
SELECT id, id, firstname FROM names UNION ALL SELECT id, NULL, NULL FROM names UNION ALL SELECT id, NULL, NULL from names UNION ALL SELECT id, firstname, NULL from names;
SELECT id, id, firstname FROM names UNION ALL SELECT id, NULL, NULL FROM names UNION ALL SELECT id, firstname, NULL from names UNION ALL SELECT id, NULL, NULL from names;
SELECT id, id, firstname FROM names UNION ALL SELECT id, firstname, NULL FROM names UNION ALL SELECT id, NULL, NULL from names UNION ALL SELECT id, NULL, NULL from names;
SELECT id, firstname, firstname FROM names UNION ALL SELECT id, NULL, NULL FROM names UNION ALL SELECT id, NULL, NULL from names UNION ALL SELECT id, id, NULL from names;
SELECT id, firstname, firstname FROM names UNION ALL SELECT id, NULL, NULL FROM names UNION ALL SELECT id, id, NULL from names UNION ALL SELECT id, NULL, NULL from names;
SELECT id, firstname, firstname FROM names UNION ALL SELECT id, id, NULL FROM names UNION ALL SELECT id, NULL, NULL from names UNION ALL SELECT id, NULL, NULL from names;
SELECT id, NULL, firstname FROM names UNION ALL SELECT id, firstname, NULL FROM names UNION ALL SELECT id, NULL, NULL from names UNION ALL SELECT id, id, NULL from names;
SELECT id, NULL, firstname FROM names UNION ALL SELECT id, firstname, NULL FROM names UNION ALL SELECT id, id, NULL from names UNION ALL SELECT id, NULL, NULL from names;
SELECT id, NULL, firstname FROM names UNION ALL SELECT id, id, NULL FROM names UNION ALL SELECT id, firstname, NULL from names UNION ALL SELECT id, NULL, NULL from names;
SELECT id, NULL, firstname FROM names UNION ALL SELECT id, id, NULL FROM names UNION ALL SELECT id, NULL, NULL from names UNION ALL SELECT id, firstname, NULL from names;
SELECT id, NULL, firstname FROM names UNION ALL SELECT id, NULL, NULL FROM names UNION ALL SELECT id, id, NULL from names UNION ALL SELECT id, firstname, NULL from names;
SELECT id, NULL, firstname FROM names UNION ALL SELECT id, NULL, NULL FROM names UNION ALL SELECT id, firstname, NULL from names UNION ALL SELECT id, id, NULL from names;

SELECT * FROM names n1 INNER JOIN names n2 ON n1.id = n2.id
UNION ALL
(
  SELECT id, firstName, lastName, NULL, NULL, '' FROM names
  EXCEPT ALL
  SELECT n1.id, n1.firstName, n1.lastName, ''::text, NULL, NULL FROM names n1 INNER JOIN names n2 ON n1.id = n2.id
);

--------------------------------------------------------
-- Queries that use the `northwind` database
--------------------------------------------------------

-- Union of INTEGER and NUMERIC should not issue type mismatch error
SELECT * FROM (SELECT Price FROM Products UNION SELECT ProductID FROM Products) LIMIT 1;

-- Arithmetic operation of INTEGER and NUMERIC should not issue type mismatch error
SELECT Price + ProductID FROM Products LIMIT 1;

-- Union of NUMERIC and STRING/VARCHAR should issue type mismatch error
SELECT Price FROM Products UNION SELECT ProductName FROM Products LIMIT 1;

-- Arithmetic operation of NUMERIC and STRING/VARCHAR should issue type mismatch error
SELECT Price + ProductName FROM Products LIMIT 1;

-- Union of INTEGER and STRING/VARCHAR should issue type mismatch error
SELECT ProductID FROM Products UNION SELECT ProductName FROM Products LIMIT 1;

-- Arithmetic operation of INTEGER and STRING/VARCHAR should issue type mismatch error
SELECT ProductID + ProductName FROM Products LIMIT 1;

ID|FIRSTNAME|???
0||Zero
1||Acid
2||Cereal
3||Lord
4||Joey
5||Zero
0|Zero|
1|Acid|
2|Cereal|
3|Lord|
4|Joey|
5|Zero|
(12 rows)
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types INTEGER and VARCHAR cannot be matched
LINE 1: ...ROM names UNION ALL SELECT id, id, NULL FROM names UNION ALL SEL...
                                          ^^
LINE 1: ...ULL FROM names UNION ALL SELECT id, firstname, NULL from names;
                                               ^^^^^^^^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types INTEGER and VARCHAR cannot be matched
LINE 1: SELECT id, id, firstname FROM names UNION ALL SELECT id, NULL, N...
                   ^^
LINE 1: ...ULL FROM names UNION ALL SELECT id, firstname, NULL from names;
                                               ^^^^^^^^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types INTEGER and VARCHAR cannot be matched
LINE 1: SELECT id, id, firstname FROM names UNION ALL SELECT id, firstna...
                   ^^
LINE 1: ...names UNION ALL SELECT id, firstname, NULL FROM names UNION ALL...
                                      ^^^^^^^^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types INTEGER and VARCHAR cannot be matched
LINE 1: SELECT id, id, firstname FROM names UNION ALL SELECT id, NULL, N...
                   ^^
LINE 1: ...ULL from names UNION ALL SELECT id, firstname, NULL from names;
                                               ^^^^^^^^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types INTEGER and VARCHAR cannot be matched
LINE 1: SELECT id, id, firstname FROM names UNION ALL SELECT id, NULL, N...
                   ^^
LINE 1: ...names UNION ALL SELECT id, firstname, NULL from names UNION ALL...
                                      ^^^^^^^^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types INTEGER and VARCHAR cannot be matched
LINE 1: SELECT id, id, firstname FROM names UNION ALL SELECT id, firstna...
                   ^^
LINE 1: ...names UNION ALL SELECT id, firstname, NULL FROM names UNION ALL...
                                      ^^^^^^^^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types VARCHAR and INTEGER cannot be matched
LINE 1: SELECT id, firstname, firstname FROM names UNION ALL SELECT id,...
                   ^^^^^^^^^
LINE 1: ... NULL, NULL from names UNION ALL SELECT id, id, NULL from names;
                                                       ^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types VARCHAR and INTEGER cannot be matched
LINE 1: SELECT id, firstname, firstname FROM names UNION ALL SELECT id,...
                   ^^^^^^^^^
LINE 1: ...ROM names UNION ALL SELECT id, id, NULL from names UNION ALL SEL...
                                          ^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types VARCHAR and INTEGER cannot be matched
LINE 1: SELECT id, firstname, firstname FROM names UNION ALL SELECT id,...
                   ^^^^^^^^^
LINE 1: ...ROM names UNION ALL SELECT id, id, NULL FROM names UNION ALL SEL...
                                          ^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types VARCHAR and INTEGER cannot be matched
LINE 1: ...names UNION ALL SELECT id, firstname, NULL FROM names UNION ALL...
                                      ^^^^^^^^^
LINE 1: ... NULL, NULL from names UNION ALL SELECT id, id, NULL from names;
                                                       ^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types VARCHAR and INTEGER cannot be matched
LINE 1: ...names UNION ALL SELECT id, firstname, NULL FROM names UNION ALL...
                                      ^^^^^^^^^
LINE 1: ...ROM names UNION ALL SELECT id, id, NULL from names UNION ALL SEL...
                                          ^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types INTEGER and VARCHAR cannot be matched
LINE 1: ...ROM names UNION ALL SELECT id, id, NULL FROM names UNION ALL SEL...
                                          ^^
LINE 1: ...names UNION ALL SELECT id, firstname, NULL from names UNION ALL...
                                      ^^^^^^^^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types INTEGER and VARCHAR cannot be matched
LINE 1: ...ROM names UNION ALL SELECT id, id, NULL FROM names UNION ALL SEL...
                                          ^^
LINE 1: ...ULL from names UNION ALL SELECT id, firstname, NULL from names;
                                               ^^^^^^^^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types INTEGER and VARCHAR cannot be matched
LINE 1: ...ROM names UNION ALL SELECT id, id, NULL from names UNION ALL SEL...
                                          ^^
LINE 1: ...ULL from names UNION ALL SELECT id, firstname, NULL from names;
                                               ^^^^^^^^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types VARCHAR and INTEGER cannot be matched
LINE 1: ...names UNION ALL SELECT id, firstname, NULL from names UNION ALL...
                                      ^^^^^^^^^
LINE 1: ...tname, NULL from names UNION ALL SELECT id, id, NULL from names;
                                                       ^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION ALL types INTEGER and VARCHAR cannot be matched
LINE 1: SELECT * FROM names n1 INNER JOIN names n2 ON n1.id = n2.id
               ^
LINE 6: ...n1.firstName, n1.lastName, ''::text, NULL, NULL FROM names n1 I...
                                       ^^^^^^^
PRICE
18
(1 row)
PRICE
19
(1 row)
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION types NUMERIC and VARCHAR cannot be matched
LINE 1: SELECT Price FROM Products UNION SELECT ProductName FROM Produc...
               ^^^^^
LINE 1: ...e FROM Products UNION SELECT ProductName FROM Products LIMIT 1;
                                        ^^^^^^^^^^^
[ERROR]: ERR_TYPE_NOT_COMPATIBLE: Type VARCHAR not compatible for arithmetic operations
LINE 1: SELECT Price + ProductName FROM Products LIMIT 1;
                       ^^^^^^^^^^^
[ERROR]: ERR_SETOPER_TYPE_MISMATCH: UNION types INTEGER and VARCHAR cannot be matched
LINE 1: SELECT ProductID FROM Products UNION SELECT ProductName FROM Pr...
               ^^^^^^^^^
LINE 1: ...D FROM Products UNION SELECT ProductName FROM Products LIMIT 1;
                                        ^^^^^^^^^^^
[ERROR]: ERR_TYPE_NOT_COMPATIBLE: Type VARCHAR not compatible for arithmetic operations
LINE 1: SELECT ProductID + ProductName FROM Products LIMIT 1;
                           ^^^^^^^^^^^
